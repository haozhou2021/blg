---
title: 双赋值在语言间的区别
date: 2022-09-28 20:37:23
tags: language
---

### 先看两段代码

> Python代码

```python
class single_node(object):
    def __init__(self):
        self.next = None

def test_unit():
    node = single_node()
    # 方式1
    node, node.next = node.next, None

    # 方式2
    node.next, node = None, node.next


if __name__ == "__main_":
    test_unit()

```

> Golang代码

```golang
type myStruct struct {
	Next *myStruct
	Name string
}

func testUnit() {
	m1 := &myStruct{
		Next:nil,
	}

	// 方式1
	//m1, m1.Next = m1.Next, nil

	// 方式2
	m1.Next, m1 = nil, m1.Next
}

func main() {
	testUnit()
}
```

### 表现

> 同样是双赋值，python的方式1会报错， 方式2不会报错；
> golang的两种方式都不会panic。

### 原理

####  python的双赋值

> 先将右边的元素一个个取地址，再将地址按顺序扔到tuple（不可变数组）里，
> 然后按下标给左边的变量。
> 所以python方式1报错的原因是:node.next是None，此时node是None，None没有Next字段。

#### golang的双赋值

> 从编译看，类似：
>
> ```golang
> a, b := 1, 2
>
> aTemp := b
> bTemp := a
>
> a = aTemp
> b= bTemp
> ```
>
> 就是把赋值给中间变量的操作隐式起来了。
